<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons.css">

<style>
  body {
    margin: 0;
  }
</style>

<p>We found a model from a previous solve that did not finish solving.
   This can happen if the solve exceeds the internal timelimit of Google Sheets, or the solve is interrupted for any reason.</p>
<p>The model was on the sheet: <b><?= getCachedSheetName() ?></b></p>
<p>We saved the progress of this solve, would you like to resume from where it left off?</p>
<section class="button-bar">
  <button class="action" onclick="resume()">Resume Solve</button>
  <button onclick="cancel()">Start New Solve with Selected Model</button>
</section>

<script>
  /**
   * The ID of this dialog. This is set once when the template is rendered.
   */
  var DIALOG_ID = '<?= dialogId ?>';
  /**
   * How often to check-in with the server, in seconds.
   */
  var CHECKIN_INTERVAL_SECONDS = 3;
  // Sets up an interval to check-in with the server every few seconds, so we can tell
  // if it's been X-ed out.
  window.setInterval(function() {
    google.script.run.checkIn(DIALOG_ID);
  }, CHECKIN_INTERVAL_SECONDS * 1000);
  /**
   * Runs when the form is submitted.
   */
  function resume() {
    // Here is where you would add custom logic specific to your form.
    // You may need to make additional google.script.run calls to store various information
    // collected in the dialog.
    google.script.run
        .withSuccessHandler(close)
        .setDialogState(DIALOG_ID, 'done');
  }
  /**
   * Runs when the cancel button is clicked.
   */
  function cancel() {
    google.script.run
        .withSuccessHandler(close)
        .setDialogState(DIALOG_ID, 'aborted');
  }
  /**
   * Closes the dialog.
   */
  function close() {
    google.script.host.close();
  }
</script>
